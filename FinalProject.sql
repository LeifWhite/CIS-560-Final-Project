/*********************
 * Drop Tables
 *********************/
IF SCHEMA_ID(N'Apartments') IS NULL
   EXEC(N'CREATE SCHEMA [Apartments];');
GO

DROP TABLE IF EXISTS Apartments.ClientUnit;
DROP TABLE IF EXISTS Apartments.Client;
DROP TABLE IF EXISTS Apartments.Unit;
DROP TABLE IF EXISTS Apartments.Complex;
DROP TABLE IF EXISTS Apartments.Landlord;

/******************
 * Create Tables
 ******************/

CREATE TABLE Apartments.Client
(
   ClientID INT NOT NULL IDENTITY(1, 1) PRIMARY KEY,
   Email NVARCHAR(128) NOT NULL UNIQUE,
   Phone NVARCHAR(32) NOT NULL UNIQUE,
   [Name] NVARCHAR(64) NOT NULL,
);
CREATE TABLE Apartments.Landlord
(
   LandlordID INT NOT NULL IDENTITY(1, 1) PRIMARY KEY,
   Email NVARCHAR(128) NOT NULL UNIQUE,
   Phone NVARCHAR(32) NOT NULL UNIQUE,
   [Name] NVARCHAR(64) NOT NULL,
);
CREATE TABLE Apartments.Complex
(
   ComplexID INT NOT NULL IDENTITY(1, 1) PRIMARY KEY,
   LandlordID INT NOT NULL FOREIGN KEY REFERENCES Apartments.Landlord(LandlordID),
   MapURL NVARCHAR(512) NOT NULL UNIQUE,
   StreetAddress NVARCHAR(128) NOT NULL,
   City NVARCHAR(64) NOT NULL,
   [State] NVARCHAR(64) NOT NULL,
   Zipcode INT NOT NULL,
   ComplexName NVARCHAR(64) NOT NULL,

   CONSTRAINT UC_ComplexAddress UNIQUE (StreetAddress, City, [State], Zipcode)
);
CREATE TABLE Apartments.Unit
(
   UnitID INT NOT NULL IDENTITY(1, 1) PRIMARY KEY,
   ComplexID INT NOT NULL FOREIGN KEY REFERENCES Apartments.Complex(ComplexID),
   UnitNumber NVARCHAR(128) NOT NULL UNIQUE, 
   AskedPrice FLOAT NOT NULL,
   Bedrooms INT NOT NULL,
   Bathrooms INT NOT NULL,
   HasLaundry BIT NOT NULL,
   HasParking BIT NOT NULL,
   IsPetFriendly BIT NOT NULL,
   IsRemoved BIT,
);
CREATE TABLE Apartments.ClientUnit
(
   ClientUnitID INT NOT NULL IDENTITY(1, 1) PRIMARY KEY,
   UnitID INT NOT NULL FOREIGN KEY REFERENCES Apartments.Unit(UnitID),
   ClientID INT NOT NULL FOREIGN KEY REFERENCES Apartments.Client(ClientID),
   Rent FLOAT,
   MoveInDate DATETIME2(0) NOT NULL,
   MoveOutDate DATETIME2(0),

   CHECK(MoveOutDate>MoveInDate),
   CONSTRAINT UC_UnitDate UNIQUE  (MoveInDate, UnitID),
   CONSTRAINT UC_ClientDate UNIQUE  (MoveInDate, ClientID), 
);
GO
/**Inserts Data into Client**/

INSERT INTO Apartments.Client ([Name],Email,Phone) VALUES (N'Austin Everett', N'Ut@est.edu', N'1-388-329-3130'),(N'Patience Underwood', N'non@fringillamilacinia.co.uk', N'248-0908'),(N'Quamar Ashley', N'magna@Nullam.edu', N'1-365-877-4421'),(N'Lani Gillespie', N'libero.mauris@tortordictum.org', N'1-212-322-0513'),(N'Judah Ortega', N'ligula.Nullam@asollicitudinorci.com', N'507-7698'),(N'Wyoming Collier', N'In.faucibus.Morbi@necdiamDuis.edu', N'1-110-669-3961'),(N'Drew Decker', N'ipsum@lobortis.net', N'394-7552'),(N'Minerva Velasquez', N'sapien.Cras@anteVivamus.co.uk', N'855-1125'),(N'Madeline Snyder', N'turpis@convallisconvallis.org', N'1-387-211-4077'),(N'Hedwig Valdez', N'nec@velfaucibusid.com', N'1-966-795-0688');
INSERT INTO Apartments.Client ([Name],Email,Phone) VALUES (N'Clio Potts', N'tristique.ac.eleifend@adipiscing.com', N'928-6352'),(N'Aidan Key', N'dictum.mi.ac@velmaurisInteger.ca', N'327-4608'),(N'Hilel Baldwin', N'lobortis.mauris@libero.ca', N'1-189-402-3613'),(N'Colette Lancaster', N'Cum.sociis@et.co.uk', N'1-601-205-1311'),(N'Lani Hubbard', N'nunc.interdum@auguescelerisque.org', N'654-5185'),(N'Jarrod Joyner', N'Aliquam@iaculis.org', N'186-4921'),(N'Burke Walter', N'Quisque.varius@tristiquesenectus.co.uk', N'1-479-171-3677'),(N'Moana Howell', N'dignissim.magna@pharetraQuisqueac.ca', N'473-5886'),(N'Eliana Thomas', N'turpis@blanditmattisCras.com', N'348-8885'),(N'Julie Hinton', N'Nunc.commodo@dolorelitpellentesque.net', N'665-8650');
INSERT INTO Apartments.Client ([Name],Email,Phone) VALUES (N'Harrison Greene', N'eros@Integervitae.com', N'1-361-713-3222'),(N'Eric Burton', N'blandit.mattis@lorem.org', N'1-201-310-4910'),(N'Cody Hensley', N'Donec.tempor@gravida.edu', N'201-1316'),(N'Grace Rose', N'Sed.eu.eros@pellentesquea.ca', N'599-6939'),(N'Pandora Melendez', N'Sed.malesuada.augue@felisNulla.ca', N'799-9124'),(N'Marsden Lowery', N'Sed.diam@eratvelpede.com', N'823-9758'),(N'Alana Harris', N'eu.eros.Nam@Donec.edu', N'850-0092'),(N'Nadine Henry', N'dolor@nequeNullamut.org', N'471-8369'),(N'Ryan Wilkerson', N'sit.amet.nulla@Maurisvelturpis.co.uk', N'238-4458'),(N'Bree Bauer', N'vitae@amet.com', N'917-6971');
INSERT INTO Apartments.Client ([Name],Email,Phone) VALUES (N'Ella Norris', N'Aliquam@euodio.edu', N'1-354-243-2492'),(N'Erin Newton', N'Duis.a.mi@blanditat.com', N'1-479-675-6849'),(N'Ross Miles', N'dis.parturient.montes@ametmassaQuisque.ca', N'1-675-878-1741'),(N'Kenyon Sanders', N'nascetur.ridiculus@Vivamus.com', N'1-605-434-4912'),(N'Oscar Burt', N'cursus.Nunc.mauris@eget.edu', N'1-769-593-3632'),(N'Emerson Mejia', N'enim.mi@adipiscing.co.uk', N'723-7756'),(N'Tyler Montgomery', N'consequat.purus.Maecenas@duilectusrutrum.org', N'635-4717'),(N'Marshall Baker', N'mattis.velit.justo@placeratCrasdictum.com', N'1-559-665-6034'),(N'Kirby Morin', N'vel.arcu.Curabitur@faucibusorciluctus.org', N'1-701-627-1181'),(N'Courtney Knox', N'egestas@Sedcongue.org', N'432-6958');
INSERT INTO Apartments.Client ([Name],Email,Phone) VALUES (N'Brendan Meyer', N'vel.nisl.Quisque@sagittis.org', N'1-317-557-6752'),(N'Mercedes Moreno', N'diam.dictum.sapien@diamdictum.net', N'1-253-426-1972'),(N'Hedley Montoya', N'eu@molestiearcuSed.net', N'1-686-427-3242'),(N'Daryl Rush', N'libero@accumsansedfacilisis.ca', N'1-847-255-6725'),(N'Jolene Parks', N'imperdiet.ullamcorper@augue.edu', N'383-8538'),(N'Ivor Strickland', N'purus.in@quamCurabitur.net', N'717-4014'),(N'Adrian Hancock', N'bibendum.fermentum@quis.net', N'117-0679'),(N'Alan Dillard', N'non@Maurisnon.net', N'1-975-209-7678'),(N'Nathaniel Holmes', N'nisl@magna.edu', N'216-4229'),(N'Oren Gaines', N'Nunc@Nullamvitae.co.uk', N'1-684-257-6072');
INSERT INTO Apartments.Client ([Name],Email,Phone) VALUES (N'Hiram Park', N'malesuada.malesuada.Integer@dignissimpharetraNam.co.uk', N'154-8960'),(N'Leila Hess', N'dictum@nonluctus.org', N'676-6395'),(N'Wyatt Buckner', N'interdum.enim.non@nibh.org', N'1-140-743-7260'),(N'Mannix Walters', N'ipsum@eratvolutpatNulla.net', N'1-242-562-4766'),(N'Gail Skinner', N'gravida.sagittis.Duis@ultrices.com', N'274-6663'),(N'Callum Jacobson', N'ullamcorper.magna.Sed@risus.org', N'1-689-973-1095'),(N'Yael Marks', N'faucibus.lectus@mauris.co.uk', N'475-0421'),(N'Jameson Potter', N'adipiscing.elit.Etiam@eusemPellentesque.org', N'1-759-271-3476'),(N'Derek Haynes', N'imperdiet@Craseutellus.org', N'434-1676'),(N'Rooney Tanner', N'dictum.cursus@mauris.net', N'699-2343');
INSERT INTO Apartments.Client ([Name],Email,Phone) VALUES (N'Raja Velasquez', N'Sed.nec.metus@inmolestie.org', N'321-3124'),(N'Kaye Keith', N'lobortis.tellus.justo@estvitae.net', N'158-2227'),(N'Alan Bennett', N'lorem.vitae.odio@temporbibendumDonec.com', N'1-712-525-8680'),(N'Aquila Hancock', N'Curabitur.dictum@luctusfelispurus.co.uk', N'245-9351'),(N'Ori Baldwin', N'accumsan.neque@aliquetProin.com', N'1-171-819-1248'),(N'Ina Keith', N'ac.sem.ut@rhoncusNullam.co.uk', N'738-7641'),(N'Stephanie Singleton', N'convallis.dolor@commodoatlibero.co.uk', N'645-8520'),(N'Zahir Cooley', N'diam.Pellentesque.habitant@sapien.org', N'499-6323'),(N'Kathleen Harrington', N'orci.Ut@tinciduntnibhPhasellus.net', N'902-1800'),(N'Jamal Dillard', N'aptent@loremeu.com', N'480-6282');
INSERT INTO Apartments.Client ([Name],Email,Phone) VALUES (N'Odysseus Pruitt', N'mi.pede.nonummy@vel.co.uk', N'1-557-955-9060'),(N'May Odonnell', N'lorem.Donec@Crasvulputate.com', N'1-842-114-0385'),(N'May Ross', N'porttitor@et.co.uk', N'179-6541'),(N'Madeson Yates', N'quis.pede.Praesent@convallisante.net', N'1-300-203-0991'),(N'Victor Blanchard', N'lacus.pede.sagittis@etmagnisdis.ca', N'306-8190'),(N'Florence Hernandez', N'ante.Vivamus@dolor.net', N'1-670-829-8274'),(N'Maryam Brock', N'et@id.com', N'647-9553'),(N'Joy Knox', N'Aliquam.erat.volutpat@sitametfaucibus.edu', N'1-626-248-1820'),(N'Venus Richard', N'orci@dui.ca', N'1-839-679-2964'),(N'Sybil Conner', N'odio@etultrices.org', N'969-6667');
INSERT INTO Apartments.Client ([Name],Email,Phone) VALUES (N'Colin David', N'In.nec.orci@ullamcorpernislarcu.ca', N'498-1904'),(N'Isabella Myers', N'Sed.id@suscipitnonummyFusce.ca', N'1-412-800-6087'),(N'John Keller', N'johnkeller@ksu.edu', N'785-532-6350'),(N'Rose Reid', N'convallis.ligula@necluctusfelis.ca', N'1-719-837-5679'),(N'Meghan Rose', N'Donec.felis.orci@magna.co.uk', N'224-8593'),(N'Ursa King', N'sapien.imperdiet.ornare@ipsum.org', N'1-502-344-4617'),(N'Lila Sykes', N'Curae@orciquislectus.co.uk', N'1-794-380-9168'),(N'Irene Woodard', N'Nam@enimdiamvel.ca', N'799-8606'),(N'Markis Nguyen', N'markisn@ksu.edu', N'1-950-446-4236'),(N'Leila Ellison', N'Fusce@mifelisadipiscing.co.uk', N'126-2713');
INSERT INTO Apartments.Client ([Name],Email,Phone) VALUES (N'Orlando Gould', N'sit.amet.nulla@purusNullamscelerisque.edu', N'1-519-168-9739'),(N'Lisandra Ferguson', N'tempus.mauris@Donec.net', N'683-1789'),(N'Simon Mccall', N'sem.ut.dolor@Proinvelnisl.co.uk', N'739-7980'),(N'Zane Christian', N'felis.adipiscing@lectusCum.org', N'1-289-737-5643'),(N'Amery Ross', N'faucibus.id.libero@Curabitursed.co.uk', N'838-0332'),(N'David Strickland', N'eu.euismod.ac@nectempus.org', N'1-475-686-7357'),(N'Timothy Gonzalez', N'cursus@aliquamiaculislacus.edu', N'1-702-316-9630'),(N'Hayley Conner', N'et.ipsum.cursus@Pellentesque.co.uk', N'557-2746'),(N'Timothy Bentley', N'eros@et.org', N'1-493-465-9300'),(N'Magee Chavez', N'Sed.et.libero@Donecest.org', N'1-892-328-5126');
INSERT INTO Apartments.Client ([Name],Email,Phone) VALUES (N'Hikaru Nakamura', N'chessisawesome@aol.com', N'1-234-567-8901'),(N'Fabiano Caruana', N'caruana.et.libero@moose.org', N'1-827-555-5309');

/**Inserts Data into Landlord**/
INSERT INTO Apartments.Landlord ([Name],Email,Phone) VALUES (N'Kiara Terrell', N'morbi.tristique.senectus@Quisque.co.uk', N'792-6868'),(N'Quinn Walls', N'parturient.montes.nascetur@sit.ca', N'607-4787'),(N'Caldwell Horne', N'varius.orci@pulvinar.co.uk', N'274-1961'),(N'Carl Mercado', N'Sed.auctor@milorem.ca', N'122-9345'),(N'Vincent Chan', N'magnis.dis.parturient@perconubianostra.ca', N'523-5576'),(N'Quintessa Pratt', N'Proin.eget.odio@Mauris.co.uk', N'499-4096'),(N'Benedict Guerrero', N'elit.sed@variusNam.edu', N'933-9013');

/**Inserts Data into Complex**/
INSERT INTO Apartments.Complex (LandlordID,MapURL,StreetAddress,City,[State],Zipcode, ComplexName) VALUES (5, N'https://www.google.com/maps/@41.1049995,-114.9670691,19.94z', N'123 Eget Rd.', N'Cheyenne', N'Wyoming', 31415, N'Bishop Flats'),(2, N'https://www.google.com/maps/@37.4794242,-76.2301012,11.69z', N'7794 Odio. St.', N'Sint-Gillis', N'Kansas', 92653, N'The Sicilian Suites'),(4, N'https://www.google.com/maps/@57.0900474,-135.3692649,15.14z', N'8247 Phasellus Street', N'Palma de Mallorca', N'New Jersey', 58979, N'The Grob Hills'),(2, N'https://www.google.com/maps/@36.3945414,-78.3301867,14.52z', N'9643 Nec Av.', N'Chuncheon', N'Colorado', 32384, N'Kasparov County Apartments'),(3, N'https://www.google.com/maps/@31.6835162,-103.842583,17.1z', N'4716 Magna Road', N'Cambridge Bay', N'Alaska', 62643, N'Ivory Rook Homes'),(5, N'https://www.google.com/maps/@14.7673876,-85.2464824,14.49z', N'9297 Vivamus Rd.', N'Hindupur', N'Kansas', 38327, N'Putnam Pawns'),(6, N'https://www.google.com/maps/@33.7920766,-87.9822423,16.86z', N'6041 Ornare, Av.', N'Völklingen', N'Arizona', 95028, N'Benko Gambit'),(1, N'https://www.google.com/maps/@41.3646914,-89.1136013,16.87z', N'3209 Ante St.', N'Boca del Río', N'Vermont', 24197, N'Magnus Carlsen Apartments'),(7, N'https://www.google.com/maps/@41.2210923,-87.4752431,14.47z', N'949 Rutrum, St.', N'Ludvika', N'Alabama', 16939, N'Anton Anton Apartments'),(3, N'https://www.google.com/maps/@39.0910332,-96.2450858,18.26z', N'1619 Ut St.', N'Borgomasino', N'Florida', 99375, N'John Bartholomew Flats');
INSERT INTO Apartments.Complex (LandlordID,MapURL,StreetAddress,City,[State],Zipcode, ComplexName) VALUES (2, N'https://www.google.com/maps/@39.190418,-96.5845405,19.46z', N'1701 Platt St', N'Manhattan', N'Kansas', 66506, N'Durland Hall'),(1, N'https://www.google.com/maps/@48.1919737,-1.3386238,17.85z', N'829 Eu Ave', N'Sacramento', N'California', 09749, N'Garden of the Gods'),(6, N'https://www.google.com/maps/@70.6422479,-38.6486681,16.42z', N'6148 Arcu Av.', N'Duisburg', N'Rhode Island', 44592, N'I Have No Idea Apartments'),(4, N'https://www.google.com/maps/@45.4647709,-98.0490038,14.31z', N'9764 Malesuada St.', N'Surabaya', N'Maine', 30781, N'Sun Spot'),(4, N'https://www.google.com/maps/@48.1087748,-123.1820464,15.19z', N'7570 Scelerisque Avenue', N'Rawalakot', N'Indiana', 64062, N'Hillcrest'),(3, N'https://www.google.com/maps/@45.1880699,-95.3244307,21z', N'2042 Lorem Street', N'Oamaru', N'Missouri', 86208, N'Rohleder Suites'),(5, N'https://www.google.com/maps/@37.6857722,-97.3244235,15.74z', N'4842 Donec St.', N'Galway', N'Nevada', 99862, N'Mooseman Heights'),(2, N'https://www.google.com/maps/@39.1779942,-96.6183739,19.51z', N'7176 Risus. Road', N'Gunsan', N'California', 80348, N'Goldfish Gallow'),(7, N'https://www.google.com/maps/@38.8818135,-94.8189712,16.94z', N'5066 Vestibulum Avenue', N'Monclova', N'California', 25342, N'Hogwarts School of Witchcraft and Wizardry'),(7, N'https://www.google.com/maps/@13.223653,108.4229718,16.61z', N'4205 Id, Avenue', N'Mahbubnagar', N'California', 11706, N'Know Apartments');

/**Inserts Data into Unit**/

INSERT INTO Apartments.Unit (ComplexID,UnitNumber,AskedPrice,Bedrooms,Bathrooms,HasLaundry,HasParking,IsPetFriendly) VALUES (5,N'65D',1189,2,3,1,1,1),(19,N'98X',1368,1,3,0,0,0),(11,N'38O',1688,2,1,0,1,0),(6,N'17K',771,2,3,0,1,1),(10,N'54B',1761,2,3,0,1,0),(17,N'74N',1536,1,2,0,0,0),(15,N'16H',1631,3,4,1,0,1),(13,N'03Z',1329,2,2,1,0,0),(16,N'88R',1357,1,4,0,0,1),(3,N'78M',992,1,3,0,1,1);
INSERT INTO Apartments.Unit (ComplexID,UnitNumber,AskedPrice,Bedrooms,Bathrooms,HasLaundry,HasParking,IsPetFriendly) VALUES (9,N'21Z',347,1,1,1,0,1),(20,N'31I',1064,1,4,0,1,0),(11,N'86B',1147,1,3,0,1,0),(14,N'29M',1634,3,1,0,1,0),(17,N'28H',733,3,3,1,0,1),(9,N'22F',910,3,3,1,1,1),(17,N'10L',828,3,2,1,1,0),(10,N'04Z',429,1,3,0,1,1),(4,N'04L',765,4,2,0,0,1),(10,N'71B',451,1,2,0,0,0);
INSERT INTO Apartments.Unit (ComplexID,UnitNumber,AskedPrice,Bedrooms,Bathrooms,HasLaundry,HasParking,IsPetFriendly) VALUES (1,N'18E',1729,1,1,1,0,1),(17,N'96Q',1631,3,4,0,1,1),(2,N'33N',849,3,4,0,1,0),(5,N'86J',1557,2,3,0,0,1),(12,N'89Z',1787,2,4,1,0,0),(2,N'56E',1429,4,4,1,1,1),(19,N'11W',913,2,4,0,0,1),(2,N'39G',1145,4,3,0,1,0),(20,N'96R',455,2,3,0,1,1),(13,N'16V',586,4,3,0,0,0);
INSERT INTO Apartments.Unit (ComplexID,UnitNumber,AskedPrice,Bedrooms,Bathrooms,HasLaundry,HasParking,IsPetFriendly) VALUES (8,N'43Z',1175,4,4,0,1,0),(19,N'54G',1073,4,1,1,1,0),(10,N'21T',447,2,3,1,1,0),(9,N'47A',435,1,3,0,0,0),(16,N'11F',1552,2,2,1,1,0),(7,N'25N',352,2,1,1,1,0),(9,N'99O',601,3,2,1,1,0),(3,N'39W',1509,1,1,1,0,0),(16,N'01Q',1978,1,2,1,1,1),(18,N'16S',371,1,4,0,0,0);
INSERT INTO Apartments.Unit (ComplexID,UnitNumber,AskedPrice,Bedrooms,Bathrooms,HasLaundry,HasParking,IsPetFriendly) VALUES (10,N'22Y',1808,1,2,0,0,1),(14,N'50J',533,2,4,1,0,1),(3,N'27Z',1115,1,4,1,1,0),(6,N'73Q',1789,4,4,0,0,1),(15,N'82O',1333,1,4,0,0,1),(7,N'93P',333,3,1,0,0,0),(16,N'37K',872,4,4,1,0,0),(6,N'51H',1640,4,3,1,1,1),(16,N'92W',969,1,4,0,1,1),(6,N'90D',1822,4,3,1,0,1);
INSERT INTO Apartments.Unit (ComplexID,UnitNumber,AskedPrice,Bedrooms,Bathrooms,HasLaundry,HasParking,IsPetFriendly) VALUES (20,N'07S',1580,3,4,0,1,0),(10,N'35I',1673,1,3,0,0,0),(2,N'31M',1061,4,4,0,1,0),(8,N'97J',1055,2,1,1,0,0),(3,N'72H',770,4,4,1,0,0),(8,N'91T',1166,1,1,0,1,1),(3,N'86E',1405,3,2,0,1,0),(7,N'80S',1356,2,1,0,1,1),(9,N'23D',1807,2,1,1,1,1),(4,N'85N',390,1,4,0,1,0);
INSERT INTO Apartments.Unit (ComplexID,UnitNumber,AskedPrice,Bedrooms,Bathrooms,HasLaundry,HasParking,IsPetFriendly) VALUES (5,N'92P',741,4,4,1,1,1),(6,N'23P',1391,1,3,1,0,1),(13,N'30C',1508,1,3,1,0,1),(4,N'33F',1046,3,3,0,0,1),(15,N'63M',803,4,3,1,0,1),(9,N'90F',1897,4,1,1,0,0),(3,N'55O',1567,4,3,0,0,1),(15,N'10G',1721,1,1,1,0,0),(12,N'68F',953,4,4,0,0,1),(16,N'89C',430,3,2,0,1,1);
INSERT INTO Apartments.Unit (ComplexID,UnitNumber,AskedPrice,Bedrooms,Bathrooms,HasLaundry,HasParking,IsPetFriendly) VALUES (14,N'69S',1684,3,1,0,0,0),(11,N'41Q',1907,3,4,0,1,1),(4,N'27R',1049,1,1,1,1,1),(15,N'18F',827,2,4,0,1,0),(5,N'69H',1191,4,3,1,1,1),(18,N'77K',615,1,4,0,0,0),(3,N'47Q',1681,4,3,1,1,0),(20,N'80I',856,4,1,0,0,1),(8,N'90V',930,1,3,0,0,0),(14,N'89W',1647,4,3,1,0,0);
INSERT INTO Apartments.Unit (ComplexID,UnitNumber,AskedPrice,Bedrooms,Bathrooms,HasLaundry,HasParking,IsPetFriendly) VALUES (5,N'89B',1473,2,1,1,0,0),(14,N'90H',372,1,1,1,1,1),(5,N'60K',1744,1,3,0,0,0),(7,N'10K',527,1,4,1,0,0),(3,N'77R',1910,3,2,0,1,1),(13,N'11H',470,2,2,1,1,0),(6,N'20W',1141,1,4,0,0,1),(20,N'51F',1806,3,2,1,1,0),(8,N'01U',1911,2,2,1,0,1),(18,N'16T',1994,4,3,0,0,1);
INSERT INTO Apartments.Unit (ComplexID,UnitNumber,AskedPrice,Bedrooms,Bathrooms,HasLaundry,HasParking,IsPetFriendly) VALUES (9,N'12Q',518,2,4,1,0,0),(13,N'47C',630,1,2,1,0,1),(17,N'01W',634,3,2,1,0,1),(8,N'55X',974,2,3,0,1,0),(20,N'26M',793,3,3,0,1,1),(17,N'95B',1224,1,2,1,0,1),(14,N'82H',1441,1,2,0,1,0),(8,N'81O',1018,2,1,1,1,1),(10,N'43S',1382,4,1,1,0,0),(18,N'20D',518,3,4,0,0,0);
INSERT INTO Apartments.Unit (ComplexID,UnitNumber,AskedPrice,Bedrooms,Bathrooms,HasLaundry,HasParking,IsPetFriendly) VALUES (20,N'14S',999,3,2,0,0,1),(12,N'10A',1999,4,4,1,0,1),(1,N'82Z',1399,4,2,0,1,1),(18,N'99Z',1999,4,4,1,1,1),(16,N'01A',300,1,1,0,0,0),(16,N'20E',1700,3,4,0,0,1);

/**Insert into ClientUnit**/
INSERT INTO Apartments.ClientUnit (UnitID,ClientID,MoveInDate,MoveOutDate) VALUES (4,28,'2016-07-23 00:55:23', NULL),(53,17,'2007-10-29 16:10:42', '2010-11-02 16:10:42'),(46,13,'2014-04-23 06:27:50', '2018-12-09 06:27:50'),(55,6,'2019-10-18 04:04:51', NULL),(61,3,'2014-10-03 08:35:53', NULL),(98,1,'2017-07-01 13:51:58', NULL),(79,21,'2011-11-06 06:59:59', '2018-11-18 06:59:59'),(51,58,'2013-07-27 11:19:04', '2018-07-09 11:19:04'),(14,57,'2018-08-17 03:23:42', NULL),(73,37,'2016-03-08 02:15:59', NULL);
INSERT INTO Apartments.ClientUnit (UnitID,ClientID,MoveInDate,MoveOutDate) VALUES (101,66,'2016-04-28 00:20:08', '2017-12-03 00:20:08'),(58,8,'2015-11-15 03:12:37', '2018-12-17 03:12:37'),(6,9,'2009-01-26 07:31:03', '2015-07-28 07:31:03'),(41,48,'2010-03-12 01:00:32', '2017-10-14 01:00:32'),(61,97,'2015-11-23 11:22:39', NULL),(89,77,'2010-12-22 10:57:48', '2014-12-19 10:57:48'),(30,55,'2018-08-22 05:07:55', NULL),(38,90,'2008-08-11 10:30:02', '2008-09-21 10:30:02'),(6,34,'2006-10-31 08:17:41', '2008-10-02 08:17:41'),(80,88,'2018-05-24 21:39:05', NULL);
INSERT INTO Apartments.ClientUnit (UnitID,ClientID,MoveInDate,MoveOutDate) VALUES (88,86,'2019-06-10 12:33:33', NULL),(85,18,'2009-02-14 16:19:52', '2012-10-19 16:19:52'),(50,41,'2019-09-05 11:51:56', NULL),(84,45,'2008-09-10 01:03:05', '2008-11-28 01:03:05'),(75,72,'2012-02-11 02:05:53', '2016-12-02 02:05:53'),(69,50,'2019-01-11 04:39:32', NULL),(16,38,'2012-05-30 18:23:52', '2013-06-09 18:23:52'),(20,54,'2007-06-01 19:04:43', '2010-09-01 19:04:43'),(52,14,'2005-12-17 16:19:24', '2010-12-24 16:19:24'),(25,42,'2012-09-03 08:32:48', NULL);
INSERT INTO Apartments.ClientUnit (UnitID,ClientID,MoveInDate,MoveOutDate) VALUES (106,79,'2016-12-11 05:46:33', '2016-12-24 05:46:33'),(28,89,'2018-06-25 10:42:41', '2018-10-13 10:42:41'),(97,71,'2019-04-13 23:40:27', NULL),(38,100,'2017-02-15 14:34:01', NULL),(62,67,'2006-12-16 19:00:04', '2008-12-13 19:00:04'),(3,15,'2018-09-25 21:11:23', NULL),(27,73,'2013-07-06 07:23:19', NULL),(75,51,'2006-03-28 23:00:38', '2008-09-18 23:00:38'),(13,65,'2011-01-10 12:02:12', '2018-03-10 12:02:12'),(65,25,'2016-08-02 12:07:36', NULL);
INSERT INTO Apartments.ClientUnit (UnitID,ClientID,MoveInDate,MoveOutDate) VALUES (102,96,'2013-02-21 11:17:48', '2016-08-21 11:17:48'),(57,93,'2010-11-13 19:13:13', '2014-11-24 19:13:13'),(69,26,'2006-08-06 13:18:08', '2012-12-21 13:18:08'),(19,63,'2018-07-04 22:44:21', NULL),(96,85,'2014-05-08 12:12:43', '2018-05-14 12:12:43'),(2,18,'2011-12-28 03:59:17', '2013-12-07 03:59:17'),(99,4,'2010-08-04 20:27:25', '2012-11-23 20:27:25'),(11,66,'2010-11-02 01:30:54', '2010-12-09 01:30:54'),(45,22,'2013-07-19 02:50:55', '2013-07-28 02:50:55'),(24,41,'2010-03-01 05:59:35', '2016-08-02 05:59:35');
INSERT INTO Apartments.ClientUnit (UnitID,ClientID,MoveInDate,MoveOutDate) VALUES (103,87,'2010-08-06 12:47:22', '2016-09-18 12:47:22'),(73,69,'2016-12-21 04:11:23', NULL),(68,45,'2018-05-06 17:07:47', NULL),(23,63,'2016-12-27 03:48:32', '2018-12-15 03:48:32'),(54,89,'2008-11-08 22:02:50', '2015-12-27 22:02:50'),(91,9,'2018-07-30 02:54:27', NULL),(1,81,'2017-09-15 02:08:48', NULL),(75,96,'2016-04-05 09:10:05', NULL),(98,78,'2008-02-19 15:06:30', '2008-07-15 15:06:30'),(13,83,'2005-12-15 16:26:59', '2005-12-27 16:26:59');
INSERT INTO Apartments.ClientUnit (UnitID,ClientID,MoveInDate,MoveOutDate) VALUES (58,50,'2006-07-22 15:03:20', '2010-09-17 15:03:20'),(104,36,'2016-03-20 10:41:16', '2018-08-16 10:41:16'),(47,86,'2015-11-28 00:19:25', '2015-12-09 00:19:25'),(45,21,'2014-01-05 15:32:11', '2014-02-10 15:32:11'),(74,75,'2017-11-21 15:30:15', NULL),(24,8,'2017-03-27 00:42:42', NULL),(74,100,'2009-01-31 05:33:09', '2009-03-09 05:33:09'),(60,77,'2006-03-09 05:44:41', '2008-04-06 05:44:41'),(11,96,'2012-03-03 04:32:06', '2012-03-15 04:32:06'),(40,79,'2013-10-27 18:57:29', NULL);
INSERT INTO Apartments.ClientUnit (UnitID,ClientID,MoveInDate,MoveOutDate) VALUES (23,15,'2016-03-26 07:57:26', NULL),(48,75,'2013-04-22 20:27:13', '2014-07-03 20:27:13'),(2,20,'2011-08-24 12:27:02', '2013-10-19 12:27:02'),(66,49,'2010-05-23 03:39:15', '2010-10-01 03:39:15'),(50,97,'2008-10-10 20:55:34', '2015-10-18 20:55:34'),(99,99,'2014-10-29 10:23:45', NULL),(16,74,'2011-02-08 05:59:01', '2012-02-07 05:59:01'),(76,69,'2007-11-10 11:58:05', '2013-12-11 11:58:05'),(16,62,'2010-05-03 09:09:50', '2011-12-25 09:09:50'),(26,47,'2019-07-20 08:30:21', NULL);
INSERT INTO Apartments.ClientUnit (UnitID,ClientID,MoveInDate,MoveOutDate) VALUES (22,59,'2012-02-25 01:56:06', '2012-04-05 01:56:06'),(94,33,'2015-02-15 16:36:23', NULL),(42,27,'2013-02-02 07:30:13', '2019-05-21 07:30:13'),(18,92,'2012-08-08 21:36:35', '2016-10-18 21:36:35'),(94,85,'2019-05-23 04:37:58', NULL),(93,46,'2016-11-11 21:33:10', NULL),(36,55,'2012-10-22 03:28:54', '2019-10-27 03:28:54'),(12,35,'2019-01-09 21:30:10', NULL),(75,96,'2013-02-03 13:31:21', '2017-10-18 13:31:21'),(37,75,'2018-06-13 09:45:12', NULL);
INSERT INTO Apartments.ClientUnit (UnitID,ClientID,MoveInDate,MoveOutDate) VALUES (54,3,'2009-04-21 07:16:25', '2011-04-26 07:16:25'),(77,42,'2017-02-12 15:45:41', NULL),(40,87,'2018-06-16 22:03:53', NULL),(75,50,'2014-09-24 05:34:03', '2015-09-20 05:34:03'),(92,6,'2007-01-03 11:18:13', '2008-10-26 11:18:13'),(27,95,'2010-10-12 14:18:16', '2017-12-19 14:18:16'),(69,8,'2018-01-12 00:31:25', NULL),(57,31,'2009-01-09 07:35:05', '2010-08-19 07:35:05'),(24,32,'2013-03-25 17:57:05', '2015-04-14 17:57:05'),(1,36,'2017-11-26 05:12:35', '2018-11-09 05:12:35');
INSERT INTO Apartments.ClientUnit (UnitID,ClientID,MoveInDate,MoveOutDate) VALUES (55,4,'2008-05-26 17:33:26', '2013-08-24 17:33:26'),(99,64,'2011-07-18 00:03:34', '2012-07-18 00:03:34'),(53,28,'2008-01-22 07:16:17', '2014-10-24 07:16:17'),(63,88,'2011-02-20 03:06:02', '2016-11-17 03:06:02'),(42,45,'2010-01-28 01:33:39', '2016-10-24 01:33:39'),(61,67,'2015-08-20 18:27:53', NULL),(41,49,'2017-06-10 04:27:37', NULL),(82,73,'2014-08-01 01:40:24', '2019-11-05 01:40:24'),(44,88,'2010-11-19 10:20:10', '2014-11-11 10:20:10'),(78,78,'2016-11-21 13:57:15', '2017-11-04 13:57:15');
INSERT INTO Apartments.ClientUnit (UnitID,ClientID,MoveInDate,MoveOutDate) VALUES (50,84,'2014-02-22 16:36:30', '2019-02-11 16:36:30'),(33,64,'2014-05-04 17:44:11', '2019-08-02 17:44:11'),(82,30,'2014-11-03 06:47:31', '2015-11-09 06:47:31'),(49,17,'2007-04-27 00:27:28', '2012-04-26 00:27:28'),(29,61,'2019-09-01 12:53:17', NULL),(73,50,'2013-07-26 18:34:43', NULL),(58,2,'2019-04-14 13:36:06', NULL),(99,57,'2007-10-20 13:48:43', '2013-10-14 13:48:43'),(84,71,'2009-11-21 07:07:05', '2011-12-11 07:07:05'),(92,31,'2014-03-11 07:10:03', NULL);
INSERT INTO Apartments.ClientUnit (UnitID,ClientID,MoveInDate,MoveOutDate) VALUES (41,75,'2015-02-24 15:48:33', '2019-06-05 15:48:33'),(66,71,'2010-08-24 01:48:06', '2010-12-06 01:48:06'),(6,2,'2013-11-12 23:38:20', '2016-12-24 23:38:20'),(51,51,'2012-11-09 08:17:18', '2012-11-22 08:17:18'),(16,51,'2008-10-20 05:51:47', '2013-12-22 05:51:47'),(23,61,'2019-08-15 15:21:10', NULL),(96,48,'2014-08-03 18:30:24', '2019-08-10 18:30:24'),(63,53,'2012-03-22 04:17:16', '2015-03-22 04:17:16'),(73,53,'2013-09-08 20:22:15', '2016-11-27 20:22:15'),(1,61,'2015-11-29 21:06:51', '2019-11-04 21:06:51');
INSERT INTO Apartments.ClientUnit (UnitID,ClientID,MoveInDate,MoveOutDate) VALUES (86,49,'2011-12-16 05:46:54', '2011-12-25 05:46:54'),(48,74,'2011-02-20 17:49:29', '2017-05-03 17:49:29'),(84,100,'2016-12-31 19:36:01', NULL),(88,20,'2012-10-23 10:46:04', '2014-12-02 10:46:04'),(14,66,'2006-11-07 13:15:43', '2009-12-24 13:15:43'),(50,8,'2013-07-02 15:07:17', NULL),(69,32,'2014-04-30 11:15:30', NULL),(69,78,'2007-03-10 05:10:51', '2007-04-25 05:10:51'),(77,62,'2007-04-18 05:26:16', '2009-10-07 05:26:16'),(14,91,'2006-02-24 22:29:48', '2008-12-19 22:29:48');
INSERT INTO Apartments.ClientUnit (UnitID,ClientID,MoveInDate,MoveOutDate) VALUES (49,69,'2014-10-03 14:14:35', '2015-12-21 14:14:35'),(15,92,'2015-10-10 20:56:27', '2019-11-03 20:56:27'),(3,59,'2006-02-19 06:06:05', '2007-04-12 06:06:05'),(47,44,'2010-03-18 13:38:44', '2017-06-22 13:38:44'),(13,58,'2012-12-14 21:30:50', '2016-12-01 21:30:50'),(73,52,'2010-09-12 16:37:30', '2015-10-05 16:37:30'),(25,9,'2009-10-14 12:41:32', '2012-11-06 12:41:32'),(69,27,'2019-01-15 11:13:25', NULL),(77,55,'2008-04-09 17:14:55', '2014-12-24 17:14:55'),(40,88,'2015-07-09 22:18:10', '2016-09-01 22:18:10');
INSERT INTO Apartments.ClientUnit (UnitID,ClientID,MoveInDate,MoveOutDate) VALUES (86,21,'2017-03-11 04:11:02', '2018-07-08 04:11:02'),(57,9,'2015-05-14 00:59:32', '2019-06-17 00:59:32'),(68,6,'2018-08-27 13:05:36', NULL),(4,27,'2010-07-05 17:27:20', '2014-08-18 17:27:20'),(89,86,'2013-08-20 06:47:02', '2016-09-02 06:47:02'),(85,25,'2014-06-07 17:53:27', '2018-11-28 17:53:27'),(95,12,'2018-06-28 18:48:02', '2019-10-08 18:48:02'),(62,19,'2016-08-09 18:57:41', '2018-11-09 18:57:41'),(81,59,'2013-07-03 10:04:13', '2018-08-15 10:04:13'),(15,13,'2018-01-04 17:21:02', NULL);
INSERT INTO Apartments.ClientUnit (UnitID,ClientID,MoveInDate,MoveOutDate) VALUES (15,14,'2009-12-26 02:03:42', '2010-12-23 02:03:42'),(84,35,'2011-12-25 12:26:34', '2012-12-13 12:26:34'),(45,36,'2007-02-05 15:03:08', '2009-10-09 15:03:08'),(22,65,'2008-08-18 00:30:14', '2013-12-21 00:30:14'),(12,55,'2010-04-23 00:49:55', '2016-07-22 00:49:55'),(24,49,'2013-11-26 20:37:19', '2016-12-24 20:37:19'),(22,63,'2008-04-20 05:05:09', '2014-08-11 05:05:09'),(50,71,'2015-07-03 00:38:31', NULL),(88,81,'2017-02-28 09:47:04', NULL),(72,57,'2008-06-17 02:08:29', '2011-11-09 02:08:29');
INSERT INTO Apartments.ClientUnit (UnitID,ClientID,MoveInDate,MoveOutDate) VALUES (9,44,'2018-10-17 05:19:32', NULL),(76,72,'2010-07-21 22:07:10', '2016-11-27 22:07:10'),(68,74,'2006-01-28 04:01:50', '2008-08-07 04:01:50'),(64,18,'2006-11-01 01:07:28', '2006-12-10 01:07:28'),(29,36,'2006-11-10 23:37:18', '2010-11-07 23:37:18'),(77,57,'2019-11-15 13:22:05', NULL),(47,98,'2015-08-24 07:17:46', NULL),(18,1,'2014-08-23 04:25:22', '2019-08-04 04:25:22'),(68,44,'2012-11-03 19:43:00', '2019-11-04 19:43:00'),(70,32,'2006-07-29 10:24:28', '2011-08-17 10:24:28');
INSERT INTO Apartments.ClientUnit (UnitID,ClientID,MoveInDate,MoveOutDate) VALUES (76,70,'2017-04-15 22:04:12', NULL),(77,96,'2013-10-03 00:14:09', NULL),(55,59,'2016-04-23 15:13:46', NULL),(40,79,'2016-09-16 17:59:22', '2016-10-14 17:59:22'),(42,39,'2009-02-10 09:46:32', '2014-11-22 09:46:32'),(39,70,'2011-04-18 08:46:04', '2012-09-08 08:46:04'),(8,78,'2019-01-25 18:15:30', NULL),(93,75,'2007-10-22 12:30:24', '2014-12-13 12:30:24'),(30,21,'2014-03-17 11:20:16', '2017-09-06 11:20:16'),(96,82,'2006-02-22 16:49:58', '2009-05-06 16:49:58');
INSERT INTO Apartments.ClientUnit (UnitID,ClientID,MoveInDate,MoveOutDate) VALUES (74,16,'2018-04-13 15:54:21', NULL),(26,29,'2008-03-07 04:49:00', '2014-05-27 04:49:00'),(83,57,'2007-03-10 18:07:44', '2014-11-26 18:07:44'),(90,20,'2014-01-05 05:18:04', NULL),(2,40,'2013-08-06 18:10:41', '2017-08-05 18:10:41'),(69,39,'2012-11-18 11:50:51', '2015-11-20 11:50:51'),(84,1,'2018-01-02 08:55:21', NULL),(74,23,'2010-09-3 00:50:00', '2013-09-10 00:50:00'),(98,66,'2013-10-29 21:52:23', NULL),(17,20,'2014-07-27 17:06:19', '2018-07-18 17:06:19');
INSERT INTO Apartments.ClientUnit (UnitID,ClientID,MoveInDate,MoveOutDate) VALUES (1,5,'2018-11-21 11:15:18', NULL),(98,47,'2014-12-07 12:12:20', '2018-12-19 12:12:20'),(31,75,'2016-10-21 09:28:03', NULL),(10,94,'2011-01-21 08:54:53', '2017-12-06 08:54:53'),(95,16,'2007-02-10 02:04:03', '2007-05-20 02:04:03'),(72,13,'2008-10-31 11:11:16', '2012-12-23 11:11:16'),(33,8,'2019-06-06 18:33:43', NULL),(45,55,'2018-09-01 20:30:41', NULL),(81,91,'2006-02-08 01:06:02', '2006-12-18 01:06:02'),(64,31,'2010-12-08 19:57:20', '2016-12-02 19:57:20');
INSERT INTO Apartments.ClientUnit (UnitID,ClientID,MoveInDate,MoveOutDate) VALUES (104,99,'2009-12-20 17:45:34', '2012-12-06 17:45:34'),(32,15,'2006-12-08 11:03:08', '2009-12-01 11:03:08'),(61,5,'2010-12-19 18:24:46', '2015-12-19 18:24:46'),(77,94,'2007-02-13 23:09:41', '2013-05-24 23:09:41'),(72,89,'2015-04-05 14:35:30', NULL),(91,2,'2014-10-27 21:06:37', '2017-12-05 21:06:37'),(21,3,'2015-04-23 02:28:19', NULL),(43,21,'2010-12-21 00:54:13', '2016-12-24 00:54:13'),(75,34,'2019-11-12 05:43:06', NULL),(38,74,'2007-07-09 04:25:52', '2014-11-23 04:25:52');
INSERT INTO Apartments.ClientUnit (UnitID,ClientID,MoveInDate,MoveOutDate) VALUES (105,47,'2010-06-22 05:47:43', '2015-08-20 05:47:43'),(86,30,'2014-05-09 03:41:06', '2015-11-02 03:41:06'),(52,4,'2007-04-20 08:36:22', '2013-08-18 08:36:22'),(95,48,'2006-10-28 23:53:59', '2016-10-18 23:53:59'),(20,50,'2018-10-27 05:01:35', NULL),(79,31,'2009-11-09 11:34:23', '2010-11-21 11:34:23'),(66,60,'2013-08-20 16:44:07', NULL),(63,35,'2009-01-28 18:52:51', '2009-09-23 18:52:51'),(82,28,'2018-05-02 06:35:30', NULL),(25,58,'2015-12-19 03:18:58', NULL);
INSERT INTO Apartments.ClientUnit (UnitID,ClientID,MoveInDate,MoveOutDate) VALUES (30,91,'2019-10-29 15:04:18', NULL),(72,86,'2018-11-02 08:40:24', NULL),(58,83,'2012-05-22 20:54:00', '2013-12-13 20:54:00'),(88,93,'2011-07-01 03:59:10', '2014-09-07 03:59:10'),(78,23,'2016-08-10 14:11:57', '2018-12-13 14:11:57'),(46,64,'2011-01-22 19:45:15', '2014-04-04 19:45:15'),(55,16,'2012-05-16 03:36:07', '2013-05-03 03:36:07'),(91,76,'2013-06-11 19:31:05', '2018-07-19 19:31:05'),(20,35,'2016-10-07 23:27:25', NULL),(92,78,'2009-04-21 01:54:11', '2012-04-07 01:54:11');
INSERT INTO Apartments.ClientUnit (UnitID,ClientID,MoveInDate,MoveOutDate) VALUES (80,101,'2019-07-23 16:05:18', '2019-10-28 16:05:18'),(100,60,'2019-05-16 01:40:12', '2019-10-11 01:40:12'),(11,98,'2006-07-13 10:38:51', '2010-07-11 10:38:51'),(82,73,'2014-01-17 08:02:22', '2015-03-24 08:02:22'),(68,80,'2015-09-08 02:12:32', NULL),(30,5,'2018-02-14 14:52:09', NULL),(7,8,'2008-10-22 04:58:05', '2013-12-18 04:58:05'),(66,83,'2018-12-18 14:05:58', NULL),(83,23,'2010-11-28 03:34:39', '2012-11-03 03:34:39'),(98,53,'2009-12-08 23:58:50', '2011-12-02 23:58:50');
INSERT INTO Apartments.ClientUnit (UnitID,ClientID,MoveInDate,MoveOutDate) VALUES (11,102,'2013-06-21 21:51:07', NULL),(35,15,'2007-10-21 08:37:54', '2013-10-28 08:37:54'),(1,12,'2006-12-27 18:36:54', '2008-12-25 18:36:54'),(4,26,'2018-08-23 04:54:17', '2018-11-06 04:54:17'),(92,73,'2008-11-29 09:00:22', '2008-12-09 09:00:22'),(15,7,'2013-06-10 07:57:45', '2019-06-14 07:57:45'),(63,85,'2011-01-30 15:57:48', '2012-11-08 15:57:48'),(74,95,'2010-04-04 00:11:52', '2011-10-13 00:11:52'),(17,68,'2009-04-23 17:42:50', '2009-04-26 17:42:50'),(46,74,'2014-05-29 08:43:42', NULL);
INSERT INTO Apartments.ClientUnit (UnitID,ClientID,MoveInDate,MoveOutDate) VALUES (105,81,'2006-12-05 09:55:56', '2007-12-14 09:55:56'),(18,66,'2007-10-16 10:54:50', '2012-11-16 10:54:50'),(78,1,'2017-06-07 12:39:00', '2018-11-10 12:39:00'),(37,82,'2016-09-08 15:12:05', '2016-11-23 15:12:05'),(1,67,'2013-11-09 02:27:35', '2016-11-18 02:27:35'),(4,20,'2017-02-04 00:49:18', NULL),(92,51,'2008-10-05 08:46:45', '2009-12-05 08:46:45'),(75,72,'2014-05-09 15:01:30', '2016-09-16 15:01:30'),(59,10,'2009-09-23 00:45:05', '2012-10-21 00:45:05'),(18,39,'2005-11-27 20:34:47', '2008-11-01 20:34:47');
INSERT INTO Apartments.ClientUnit (UnitID,ClientID,MoveInDate,MoveOutDate) VALUES (84,73,'2014-08-20 20:24:11', '2015-11-01 20:24:11'),(45,10,'2007-01-03 07:32:08', '2012-12-19 07:32:08'),(5,18,'2010-12-20 22:13:56', '2015-12-04 22:13:56'),(9,31,'2006-08-12 05:07:41', '2008-09-01 05:07:41'),(30,100,'2012-03-09 08:28:25', '2012-05-04 08:28:25'),(85,100,'2005-11-29 08:42:11', '2007-11-02 08:42:11'),(17,14,'2010-12-29 10:44:51', '2012-12-02 10:44:51'),(97,11,'2009-11-25 12:01:18', '2011-12-16 12:01:18'),(36,66,'2006-04-29 09:02:11', '2007-04-02 09:02:11'),(79,76,'2010-05-15 03:00:33', '2010-09-01 03:00:33');
GO

UPDATE Apartments.ClientUnit 
SET ClientUnit.Rent = U.AskedPrice* (
    (ISNULL(YEAR(CU.MoveOutDate), YEAR(SYSDATETIMEOFFSET()))-YEAR(CU.MoveInDate))*12
    +ISNULL(MONTH(CU.MoveOutDate), MONTH(SYSDATETIMEOFFSET()))-MONTH(CU.MoveInDate))
FROM Apartments.ClientUnit CU
INNER JOIN Apartments.Unit U ON CU.UnitID = U.UnitID
GO

UPDATE Apartments.Unit 
SET Unit.IsRemoved = IIF(ISNULL(CU.MoveOutDate, '9999-01-01 00:00:00') = '9999-01-01 00:00:00', 1, 0)
FROM Apartments.Unit U
INNER JOIN Apartments.ClientUnit CU ON CU.UnitID = U.UnitID
GO

SELECT CU.MoveInDate,
       CU.MoveOutDate,
       CU.Rent,
       U.AskedPrice,
       U.IsRemoved
FROM Apartments.ClientUnit CU
INNER JOIN Apartments.Unit U ON U.UnitID = CU.UnitID
GO
SELECT C.[Name],
       CX.ComplexName,
       CU.MoveInDate,
       CU.MoveOutDate,
       CU.Rent
FROM Apartments.Client C
INNER JOIN Apartments.ClientUnit CU ON CU.ClientID = C.ClientID
INNER JOIN Apartments.Unit U ON U.UnitID = CU.UnitID
INNER JOIN Apartments.Complex CX ON CX.ComplexID = U.ComplexID
--WHERE CX.ComplexName = N'Durland Hall'
ORDER BY CX.ComplexID


